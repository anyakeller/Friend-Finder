<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>KEK</title>
    <!-- Latest compiled and minified CSS & JS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://s
			tackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  </head>
  <body>
    <div class="container">
      <div class="jumbotron">
        <h1>You must be lonely</h1>
        <h3>YEET</h3>
        <hr />
      </div>

      <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h3><strong>ANSWER THIS AND YOU WILL HAVE FRIENDS</strong></h3>
            </div>
            <div class="card-body">
              <form method="POST" role="form">
                <div class="form-group textInput">
                  <label for="name">Name brah</label>
                  <input type="text" class="form-control" id="name" />
                </div>

                <div class="form-group textInput">
                  <label for="photoLink"
                    >Link to your beautiful face brah</label
                  >
                  <input type="text" class="form-control" id="photoLink" />
                </div>
                <hr />

                <div class="form-group">
                  <label for="q1"
                    >How much do you like Star Trek? (5 is yes, 1 is kinda
                    yes)</label
                  >
                  <select class="form-control selectInput" id="q1">
                    <option value></option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="q2"
                    >Are you a human? (1 is less human, 5 is more human)</label
                  >
                  <select class="form-control selectInput" id="q2">
                    <option value></option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="q3">Anya is cool</label>
                  <select class="form-control selectInput" id="q3">
                    <option value></option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="q4"
                    >How desperate are you for friends? (1 is least, 5 is
                    most)</label
                  >
                  <select class="form-control selectInput" id="q4">
                    <option value></option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="q5"
                    >Which cheese is best? (1 is cheese 1, etc...)</label
                  >
                  <select class="form-control selectInput" id="q5">
                    <option value></option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="q6">How much does potato hurt?</label>
                  <select class="form-control selectInput" id="q6">
                    <option value></option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="q7"
                    >I am running out of intrusive questions help</label
                  >
                  <select class="form-control selectInput" id="q7">
                    <option value></option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="q8">SCREAMS</label>
                  <select class="form-control selectInput" id="q8">
                    <option value></option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="q9"
                    >How bad does my fart smell? (1 is not so much, 5 is someone
                    get a gas mask)</label
                  >
                  <select class="form-control selectInput" id="q9">
                    <option value></option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="q10">YES</label>
                  <select class="form-control selectInput" id="q10">
                    <option value></option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                </div>
              </form>
              <br />
              <div class="text-right">
                <button
                  type="submit"
                  class="btn btn-primary btn-md"
                  id="getFriendsBtn"
                >
                  SUBMEET
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- MODAL THING -->
    <div
      class="modal fade"
      id="resultsModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="modalThing"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalThing">
              Inder Bootstra-like thing here
            </h5>
          </div>
          <div class="modal-body" id="yourBFF">
            UEEEET
          </div>
          <img src="" />
          <div class="modal-footer"></div>
        </div>
      </div>
    </div>

    <script type="text/javascript">
      // Question: What does this code do?
      $('#getFriendsBtn').on('click', function(event) {
        var yourScores = [
          parseInt($('#q1').val()),
          parseInt($('#q2').val()),
          parseInt($('#q3').val()),
          parseInt($('#q4').val()),
          parseInt($('#q5').val()),
          parseInt($('#q6').val()),
          parseInt($('#q7').val()),
          parseInt($('#q8').val()),
          parseInt($('#q9').val()),
          parseInt($('#q10').val()),
        ];
        event.preventDefault();
        var you = {
          name: $('#name')
            .val()
            .trim(),
          photo: $('#photoLink')
            .val()
            .trim(),
          scores: yourScores,
        };
        //console.log(you);
        //validate
        function validateIt() {
          var isGood = true;
          if (you.name === '') isGood = false;
          if (you.photo === '') isGood = false;
          for (var i = 0; i < yourScores.length; i++) {
            if (yourScores[i] === NaN) isGood = false;
          }
          return isGood;
        }

        if (validateIt()) {
          $.get('/api/friends', function(data) {
            //console.log(yourScores);
            var bff = data[0];
            var bestScore = 40;
            for (var i = 0; i < data.length; i++) {
              var difference = 0;
              for (var k = 0; k < 10; k++) {
                difference += Math.abs(
                  parseInt(data[i].scores[k]) - yourScores[k],
                );
                if (difference < bestScore) {
                  bestScore = difference;
                  bff = data[i];
                }
              }
            }
            console.log('Your BFF:', bff);

            $('#yourBFF').append($('<p>').text('Your friend is :' + bff.name));
            $('#yourBFF').append(
              $('<img>').attr({src: bff.photo, width: '200px'}),
            );
            $('#resultsModal').modal('show');
          });
          $.post('/api/friends', you, function(data) {
            console.log('Survey Answered');
          });
        } else alert("You're missing something!");
      });
    </script>
  </body>
</html>
